# Security Practices

## Quick Summary

Security patterns for [PROJECT_NAME]: authentication, authorization, input validation, and secrets management.

**Category**: Security
**Complexity**: High
**Prerequisites**: OWASP Top 10, [AUTH_METHOD]

---

## üö® SIZE LIMIT WARNING

**This generated guide MUST be 200-400 lines maximum.**

**When filling this template**:
- ‚úÖ Code examples: 5-15 lines (NEVER > 20)
- ‚úÖ ONE example per pattern
- ‚úÖ Use file:line references, not full code
- ‚úÖ Use tables for multiple patterns
- ‚ùå NO multiple examples for same pattern
- ‚ùå NO verbose explanations
- ‚ùå NO copying entire functions

**Validate line count after generation**: `wc -l [this-file]`
**If > 400 lines**: Condense immediately before continuing!

---

## Authentication

### Pattern

```[language]
# Source: [file:lines]
[auth_pattern]
```

**Method**: [JWT / OAuth2 / API Key / Session]
**Token Storage**: [Where tokens are stored]
**Expiration**: [Token lifetime]

---

## Authorization

### Pattern

```[language]
# Source: [file:lines]
[authz_pattern]
```

**Roles**: [List roles and permissions]

---

## Input Validation

### Pattern

```[language]
# Source: [file:lines]
[validation_pattern]
```

**Rules**:
- ‚úÖ Validate all input at boundaries
- ‚úÖ Use validation library/framework
- ‚úÖ Whitelist (not blacklist)
- ‚ùå Trust user input

---

## Secrets Management

### Environment Variables

```bash
# NEVER commit these
[SECRET_KEY]=[use env var]
[API_KEY]=[use secrets manager in prod]
[DB_PASSWORD]=[use secrets manager in prod]
```

**Rules**:
- ‚úÖ Environment variables for dev
- ‚úÖ Secrets manager for production
- ‚úÖ Rotate regularly
- ‚ùå Hardcode in code
- ‚ùå Commit to git
- ‚ùå Log secrets

---

## SQL Injection Prevention

```[language]
# Good: Parameterized
[good_sql_example]

# Bad: String interpolation
[bad_sql_example]
```

**Rule**: ALWAYS use parameterized queries

---

## XSS Prevention

```[language]
# Source: [file:lines]
[xss_prevention]
```

**Rules**:
- ‚úÖ Escape output
- ‚úÖ Use framework defaults
- ‚úÖ Content Security Policy headers
- ‚ùå Trust user content

---

## Security Headers

```[language]
# Source: [file:lines]
[security_headers]
```

**Required Headers**:
- `[Header1]`: `[Value]`
- `[Header2]`: `[Value]`

---

## HTTPS/TLS

**Rules**:
- ‚úÖ HTTPS everywhere in production
- ‚úÖ Valid TLS certificates
- ‚úÖ Minimum TLS 1.2+
- ‚ùå Plain HTTP for sensitive data

---

## Security Checklist

- [ ] Authentication on protected endpoints
- [ ] Authorization checks enforced
- [ ] All input validated
- [ ] SQL queries parameterized
- [ ] Secrets in env vars (not code)
- [ ] HTTPS in production
- [ ] Security headers configured
- [ ] Sensitive data encrypted
- [ ] Error messages don't leak info
- [ ] Logging excludes secrets/PII

---

## References

- **Auth Implementation**: `[path/to/auth]`
- **Validation**: `[path/to/validation]`
- **OWASP Top 10**: https://owasp.org/www-project-top-ten/

---
